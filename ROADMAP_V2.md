# خريطة تطوير الإصدار الثاني | خطوات ERP

---

## ملخص الإصدار الأول (مكتمل ✓)
- لوحة إدارة أساسية (متاجر، مستخدمين)
- لوحة تاجر (منتجات، طلبات، مظهر، إعدادات شحن، محفظة)
- تسجيل تجار عبر SaaS
- متجر Next.js متعدد الـ tenants
- ربط المتجر بالـ API وعرض البيانات بشكل صحيح
- زر عرض المتجر يعمل بشكل صحيح

---

## الإصدار الثاني – خريطة التطوير

---

## 1. لوحة تحكم الإدارة (Admin Dashboard)

### 1.1 تحسينات عامة
- [ ] **تصميم وتجربة مستخدم أفضل**
  - [x] تحسين الصفحة الرئيسية (Dashboard) بعرض إحصائيات أوسع
  - [ ] رسوم بيانية: عدد المتاجر، الطلبات، الإيرادات عبر الوقت
  - [ ] تنبيهات وإشعارات (متاجر جديدة، مشاكل، إلخ)

- [x] **إدارة المتاجر** ✓
  - [x] إيقاف/تفعيل المتجر
  - [x] عرض أداء كل متجر (طلبات، إيرادات، منتجات)
  - [x] فلاتر وبحث متقدم
  - [x] تصدير بيانات المتاجر (Excel/CSV)

- [ ] **إدارة المستخدمين**
  - [x] أدوار وصلاحيات (Super Admin, Support, etc.)
  - [ ] سجل نشاط المستخدمين
  - [ ] إدارة جلسات الدخول

### 1.2 ميزات جديدة
- [ ] **إعدادات النظام**
  - إعدادات عامة (اسم النظام، شعار، ألوان)
  - إدارة الاشتراكات أو الباقات (إن وُجدت)
  - صيانة النظام (Maintenance Mode)

- [ ] **التقارير**
  - تقارير مالية مجمّعة
  - تقارير الطلبات حسب الفترة، المتجر، الحالة
  - تقارير المنتجات الأكثر مبيعاً

---

## 2. لوحة تحكم التاجر (Seller Dashboard)

### 2.1 تحسينات عامة
- [ ] **الصفحة الرئيسية**
  - إحصائيات أوضح (طلبات اليوم، الأسبوع، الشهر)
  - رسوم بيانية للمبيعات
  - تنبيهات للطلبات الجديدة
  - اختصار لأهم الإجراءات (عرض المتجر، إضافة منتج، إلخ)

- [ ] **تحسين إدارة المنتجات**
  - رفع صور متعددة (معرض)
  - إدارة المخزون (كميات، تنبيهات نفاد)
  - تصنيفات/فئات للمنتجات
  - استيراد/تصدير المنتجات

- [ ] **تحسين إدارة المظهر**
  - معاينة حية للتغييرات
  - قوالب جاهزة (Themes)
  - تخصيص ألوان، خطوط، ترويسة وتذييل

### 2.2 ربط الدومين الخاص (Custom Domain) ✓
- [x] **واجهة التاجر**
  - حقل لإدخال الدومين (مثل: store.example.com)
  - التحقق من أن الدومين لا يُستخدم لمتجر آخر
  - تعليمات توضيحية (DNS: CNAME أو A Record)

- [x] **الباكند**
  - استخدام حقل `custom_domain` في جدول `stores`
  - تحديث `IdentifyTenant` للبحث بـ `custom_domain` أيضاً
  - حقل `custom_domain_status` (pending, approved, rejected)

- [ ] **التحقق من الدومين**
  - التحقق التلقائي عبر DNS (اختياري)
  - أو طريقة يدوية (التاجر يضيف سجل ثم يضغط "تحقق")

- [ ] **Nginx/الإعدادات**
  - توثيق أو سكربت لإضافة دومين جديد (SSL, Proxy للمتجر)

---

## 3. قسم الطلبات – التكامل والمراحل

### 3.1 مراحل الطلب (Order Status Workflow) ✓
- [x] **تحديث نموذج الطلب**
  - حالات: pending, confirmed, processing, ready_to_ship, with_delivery, shipped, delivered, completed, partial_return, full_return, cancelled
  - سجل تغيير الحالة (OrderStatusHistory) مع التاريخ والمستخدم

- [x] **واجهة التاجر**
  - تغيير الحالة، فلترة، مؤشر مرئي (Badges)

### 3.2 طباعة الفاتورة ✓
- [x] **قالب الفاتورة** (barryvdh/laravel-dompdf)
- [x] **زر طباعة** من صفحة الطلب

### 3.3 الربط مع شركات الشحن
- [x] **رقم التتبع** (tracking_number) في الطلب
- [ ] **إعدادات الشحن** (API Keys لشركات الشحن)
- [ ] **إنشاء شحنة عبر API**
- [ ] **إشعارات الشحن** (SMS/WhatsApp)

### 3.4 ميزات إضافية للطلبات ✓
- [x] **ملاحظات الطلب** (seller_notes)
- [x] **تنبيه للتاجر** (Telegram عند طلب جديد)

---

## 4. التكاملات والإشعارات

- [x] **Telegram** ✓
  - إشعار للقناة/المجموعة عند طلب جديد
  - [ ] إشعار عند تحديث حالة الطلب

- [ ] **جوجل شيتس**
  - تصدير الطلبات أو المنتجات لجدول
  - مزامنة تلقائية (اختياري)

- [ ] **البريد الإلكتروني**
  - إعداد SMTP
  - قوالب بريد للطلبات والإشعارات

---

## 5. التحسينات التقنية

- [ ] **الأداء**
  - تخزين مؤقت (Cache) للبيانات المتكررة
  - تحسين استعلامات قاعدة البيانات

- [ ] **الأمان**
  - تدقيق الصلاحيات في كل endpoint
  - Rate limiting للـ API
  - نسخ احتياطي تلقائي للبيانات

- [ ] **التوثيق**
  - توثيق API للمتجر
  - دليل استخدام لوحة الإدارة والتاجر

---

## ترتيب تنفيذ مقترح

| المرحلة | المهام | الأولوية |
|--------|--------|----------|
| **2.1** | مراحل الطلب + طباعة الفاتورة | عالية |
| **2.2** | ربط الدومين الخاص | عالية |
| **2.3** | تحسين لوحة التاجر (إحصائيات، واجهة) | متوسطة |
| **2.4** | إرسال الطلب لشركة الشحن | متوسطة |
| **2.5** | تحسين لوحة الإدارة | متوسطة |
| **2.6** | التكاملات (Telegram، بريد، إلخ) | متوسطة |
| **2.7** | التقارير والتصدير | ✓ مكتمل (طلبات + متاجر) |

---

## ملاحظات

- يمكن تقسيم كل مرحلة إلى Sprint حسب الوقت المتاح.
- يُفضّل البدء بمراحل الطلب وطباعة الفاتورة لأنها مرتبطة مباشرة بتجربة التاجر.
- ربط الدومين يتطلب تنسيق مع إعدادات السيرفر (Nginx/Cloudflare) وتوثيق واضح للتجار.
